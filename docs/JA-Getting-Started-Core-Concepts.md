# コア概念

[English](Getting-Started-Core-Concepts) | **日本語**

これらのコア概念を理解することで、Twin を効果的に使用できます。

## Git ワークツリー

Git ワークツリーを使用すると、単一のリポジトリに複数の作業ディレクトリを持つことができます。各ワークツリー：
- 独自の作業ディレクトリを持つ
- 異なるブランチをチェックアウトできる
- 同じ Git 履歴とオブジェクトを共有
- フルクローンと比較してディスク使用量を削減

Twin は Git のワークツリー機能をラップして以下を提供：
- 自動ブランチ作成
- 一貫したディレクトリ構造
- クリーンアップと管理ユーティリティ

## シンボリックリンク

シンボリックリンク（symlink）は、ショートカットとして機能するファイルまたはディレクトリへの参照です。Twin はそれらを使用して：
- 環境間で設定ファイルを共有
- 重複なしに一貫性を維持
- プラットフォーム固有の実装をサポート

### プラットフォームの違い

**Unix/Linux/macOS**:
- ネイティブシンボリックリンクサポート
- 特別な権限は不要

**Windows**:
- 開発者モードまたは管理者権限が必要
- シンボリックリンクが利用できない場合はファイルコピーにフォールバック
- 利用可能な戦略の自動検出

## ファイルマッピング

ファイルマッピングはソースとターゲットファイル間の関係を定義：

```toml
[[files]]
source = "path/to/source"      # 元のファイル
target = "path/in/worktree"    # ワークツリー内の宛先
mapping_type = "symlink"       # リンクの作成方法
skip_if_exists = true          # 既存を上書きしない
description = "目的"           # 人間が読める説明
```

### マッピングタイプ
- **symlink**: シンボリックリンクを作成（デフォルト）
- **copy**: ファイルをコピー
- **template**: テンプレートとして処理（計画中の機能）

## フック

フックは特定のライフサイクルポイントで実行されるコマンド：

- **pre_create**: ワークツリー作成前
- **post_create**: 正常作成後
- **pre_remove**: ワークツリー削除前
- **post_remove**: 正常削除後

フックコマンドは変数置換をサポート：
- `{branch}`: ブランチ名
- `{worktree_path}`: ワークツリーへのフルパス
- `{source_path}`: リポジトリルートパス

ソース: [README.md#L6-15](https://github.com/your-org/twin/blob/main/README.md#L6-15), [src/core/types.rs#L167-177](https://github.com/your-org/twin/blob/main/src/core/types.rs#L167-177)